import Crypto.PublicKey.RSA as RSA
import os
from Crypto.Util.number import *
import gmpy2


with open("key1") as f:
	n1=f.read().rstrip('\n65537\n')
with open("key2") as f:
	n2=f.read().rstrip('\n65537\n')
with open("encrypted") as f:
	c=f.read().rstrip("\n")

e=65537
#n1 = p * q
#n2 = (p+2) * (q+2)
#n2 = n1 + 2 (p+q) + 4
# P+Q = n2-n1-4   / 2
n1,n2=int(n1),int(n2)
sumpq=(n2-n1-4)/2

# we have (a+b)^2  = (a-b) ^ 2 + 4ab
diffpq = gmpy2.iroot((sumpq**2-4*n1),2)[0]
diffpq=int(diffpq)
p=(sumpq+diffpq)/2
q=n1/p

phi_n1=(p-1) * (q-1)
d1=inverse(e, phi_n1)
d2=inverse(e, (p+1) * (q+1))
m=pow(int(c),d2,n2)
m=pow(m,d1,n1)
m=hex(m)[2:-1].decode('hex')
print m

