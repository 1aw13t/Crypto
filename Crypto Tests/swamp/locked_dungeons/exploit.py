from pwn import *
import string
import sys
#context.log_level = "debug"
flag1 = "flag{rem3mber_the_pic_of_tux_aes_3ncrypted}"

io = remote("chal1.swampctf.com", 1450)
flag_size = 43;
PAD_LIMIT = 48
io.sendline("");
flag_enc = io.recvline().rstrip('\n').decode('hex')
fblocks = [flag_enc[i*16:(i+1)*16] for i in range(3)]

chars = "_{"+string.printable
flag = "\x05\x05\x05\x05\x05"

for j in range(42,-1,-1):
	for i in chars:
		buff = i+flag
		inp = buff 
		sys.stdout.write("\r"+inp)
		sys.stdout.flush()
		io.sendline(inp)
		block = io.recvline().rstrip('\n').decode('hex')[(j/16)*16:(j/16+1)*16]
		if block == fblocks[j/16]:
			flag = i + flag
			break
