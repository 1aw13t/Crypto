import random

with open("top_secret" , "rb") as a:
	ct = list(a.read())
	ct=ct[:-1] #to remove newline character
msg = ct[:- 18]
ctime="".join([chr(int(m) ^ int(k)) for (m,k) in zip(ct, [0x88] * len(ct))][-18:])
print ("The ctime is ",ctime)

random.seed(ctime)
key = [random.randrange(256) for i in msg]
print("The key is ", key)
flag= "".join([chr(int(m) ^ int(k)) for (m, k) in zip(ct, key + [0x88] * 18)])

print(flag)
